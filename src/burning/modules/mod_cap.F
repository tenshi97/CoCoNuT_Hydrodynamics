! TAK_RATES
      module cap
      use precision

      implicit none
c LOCAL variables that are not in modules

      SAVE

      real(kind=rk) :: pc_rates(69,9)

      integer(kind=ik):: ii,ij


c.. pc_rates(:,1):    log10(rho*ye)
c.. pc_rates(1,:):    log10(tem)
c.. pc_rates(2:104,2:9):    rates [nucleon^-1 s^-1], energy [mev]

      data ((pc_rates(ii,ij),ij=1,9),ii=1,69) /
     &  0., 8.2, 8.4, 8.6, 8.8, 9.0, 9.2, 9.4, 9.6,
c     20Ne --> 20F: electron capture rates
     & 9.,-81.648,-53.358,-35.286,-23.659,-16.099,-11.1, -7.701,-5.302,
     & 9.1,-68.629,-45.144,-30.102,-20.388,-14.035,-9.799,-6.882,-4.785,
     & 9.2,-56.394,-37.157,-24.931,-17.074,-11.93,-8.468,-6.038,-4.245,
     & 9.3,-54.347,-35.172,-23.066,-15.413,-10.546,-7.394,-5.256,-3.704,
     & 9.4,-53.462,-34.289,-22.189,-14.548,-9.711,-6.622,-4.595,-3.189,
     & 9.5,-38.896,-26.409,-18.309,-12.928,-8.915,-5.976,-4.023,-2.71,
     & 9.6,-19.741,-14.323,-10.683,-8.163,-6.347,-4.878,-3.424,-2.251,
     & 9.7,-3.702,-3.682,-3.635,-3.535,-3.351,-3.059,-2.563,-1.772,
     & 9.8,-1.883,-1.881,-1.878,-1.869,-1.847,-1.797,-1.663,-1.261,
     & 9.9,-1.062,-1.062,-1.061,-1.058,-1.051,-1.033,-.98,-.767,
     & 10.0,-.497,-.497,-.496,-.495,-.491,-.482,-.454,-.322,  
     & 10.1,-.04,-.039,-.039,-.038,-.036,-.03,-.012,.077, 
     & 10.2,.36,.36,.361,.361,.363,.366,.379,.442,
     & 10.3,.718,.718,.718,.719,.72,.722,.731,.788, 
     & 10.4,1.045,1.045,1.045,1.045,1.046,1.048,1.055,1.092,
     & 10.5,1.352,1.352,1.352,1.352,1.353,1.354,1.359,1.391,
     & 11.0,2.706,2.706,2.706,2.707,2.707,2.707,2.709,2.723,
c     24Mg --> 24Na: electron capture rates
     & 9.,-49.242,-33.142,-22.729,-15.892,-11.32,-8.181,-5.889,-4.054,
     & 9.1,-36.288,-25.043,-17.724,-12.864,-9.475,-7.007,-5.119,-3.546,
     & 9.2,-22.222,-16.167,-12.124,-9.350,-7.368,-5.794,-4.34,-3.014,  
     & 9.3,-7.121,-6.651,-6.134,-5.585,-5.012,-4.388,-3.509,-2.459,
     & 9.4,-3.405,-3.401,-3.39,-3.363,-3.299,-3.121,-2.640,-1.883,  
     & 9.5,-2.343,-2.337,-2.325,-2.295,-2.225,-2.076,-1.783,-1.299,  
     & 9.6,-1.217,-1.216,-1.212,-1.203,-1.180,-1.127,-1.003,-0.737,  
     & 9.7,-0.47,-0.469,-0.468,-0.464,-0.455,-0.434,-0.379,-0.230,  
     & 9.8,0.073,0.073,0.074,0.076,0.08,0.091,0.122,0.214,  
     & 9.9,0.515,0.515,0.515,0.516,0.519,0.526,0.546,0.609,  
     & 10.0,0.902,0.902,0.902,0.903,0.905,0.910,0.923,0.968,  
     & 10.1,1.250,1.25,1.25,1.251,1.252,1.256,1.265,1.298,  
     & 10.2,1.569,1.569,1.569,1.57,1.57,1.573,1.58,1.605,  
     & 10.3,1.866,1.866,1.866,1.866,1.867,1.869,1.874,1.874,  
     & 10.4,2.146,2.146,2.146,2.146,2.147,2.148,2.152,2.169,  
     & 10.5,2.412,2.412,2.412,2.412,2.413,2.414,2.417,2.431,  
     & 11.0,3.597,3.597,3.597,3.597,3.597,3.597,3.598,3.605, 
c     20Ne --> 20F: neutrino loss rates
     & 9.,-83.033,-54.542,-36.268,-24.439,-16.675,-11.468,-7.859,-5.246,
     & 9.1,-70.015,-46.328,-31.085,-21.168,-14.61,-10.166,-7.037,-4.725, 
     & 9.2,-57.372,-38.081,-25.759,-17.763,-12.449,-8.798,-6.17,-4.172,  
     & 9.3,-54.685,-35.506,-23.393,-15.72,-10.812,-7.581,-5.32,-3.601,
     & 9.4,-53.547,-34.373,-22.271,-14.624,-9.773,-6.652,-4.559,-3.036, 
     & 9.5,-40.282,-27.595,-19.29,-13.494,-8.959,-5.905,-3.894,-2.495,
     & 9.6,-21.127,-15.509,-11.667,-8.945,-6.913,-5.038,-3.273,-1.981,  
     & 9.7,-4.432,-4.393,-4.305,-4.126,-3.819,-3.354,-2.526,-1.475, 
     & 9.8,-2.028,-2.025,-2.018,-2.001,-1.959,-1.865,-1.605,-.951, 
     & 9.9,-.949,-.948,-.945,-.94,-.926,-.892,-.789,-.417,  
     & 10.0,-.21,-.21,-.209,-.206,-.2,-.183,-.131,.095,  
     & 10.1,.372,.373,.373,.375,.379,.389,.42,.569, 
     & 10.2,.872,.872,.873,.874,.876,.883,.904,1.008, 
     & 10.3,1.317,1.317,1.317,1.318,1.32,1.324,1.339,1.415, 
     & 10.4,1.722,1.722,1.723,1.723,1.724,1.728,1.738,1.797, 
     & 10.5,2.099,2.099,2.099,2.099,2.1,2.102,2.111,2.157,  
     & 11.0,3.735,3.735,3.735,3.735,3.736,3.736,3.739,3.758,
c     24Mg --> 24Na: neutrino loss rates
     & 9.,-50.601,-34.305,-23.697,-16.66,-11.884,-8.538,-6.039,-3.996,
     & 9.1,-37.674,-26.227,-18.706,-13.622,-9.991,-7.32,-5.246,-3.48, 
     & 9.2,-23.608,-17.352,-13.107,-10.13,-7.933,-6.102,-4.44,-2.936,  
     & 9.3,-8.463,-7.802,-7.089,-6.34,-5.566,-4.72,-3.603,-2.366,
     & 9.4,-3.8,-3.791,-3.77,-3.719,-3.605,-3.345, -2.717,-1.773,
     & 9.5,-2.484,-2.48,-2.47,-2.444,-2.377,-2.209,-1.821,-1.162, 
     & 9.6,-1.315,-1.312,-1.306,-1.29,-1.252,-1.165,-.963,-.552,  
     & 9.7,-.384,-.383,-.381,-.374,-.358,-.319,-.219,.026, 
     & 9.8,.313,.313,.314,.318,.326,.346,.401,.555, 
     & 9.9,.876,.876,.877,.879,.884,.896,.93,1.033,  
     & 10.0,1.361,1.361,1.361,1.363,1.366,1.374,1.397,1.47,  
     & 10.1,1.795,1.795,1.795,1.796,1.798,1.804,1.82,1.874, 
     & 10.2,2.191,2.191,2.192,2.192,2.194,2.198,2.21,2.251, 
     & 10.3,2.559,2.559,2.559,2.56,2.561,2.564,2.573,2.605, 
     & 10.4,2.904,2.904,2.905,2.905,2.906,2.908,2.915,2.941, 
     & 10.5,3.232,3.232,3.232,3.233,3.233,3.235,3.241,3.261,  
     & 11.0,4.689,4.689,4.689,4.689,4.689,4.69,4.692,4.701/
c     20Ne --> 20F: gamma ray heating rates
c     & 9.,-102.627,-66.64,-43.711,-29.021,-19.525,-13.289,-9.096,-6.196,
c     & 9.1,-89.609,-58.426,-38.528,-25.75,-17.46,-11.985,-8.271,-5.672,
c     & 9.2,-75.543,-49.52,-32.928,-22.216,-15.229,-10.576,-7.382,-5.109,  
c     & 9.3,-60.347,-39.966,-26.888,-18.416,-12.843,-9.08,-6.441,-4.513,
c     & 9.4,-54.821,-35.645,-23.533,-15.861,-10.956,-7.738,-5.523,-3.902, 
c     & 9.5,-38.871,-26.385,-18.285,-12.945,-9.272,-6.594,-4.678,-3.295,
c     & 9.6,-19.717,-14.299,-10.659,-8.139,-6.325,-4.938,-3.739,-2.679,
c     & 9.7,-3.678,-3.658,-3.611,-3.511,-3.327,-3.037,-2.623,-2.029,
c     & 9.8,-1.859,-1.857,-1.854,-1.845,-1.823,-1.773,-1.659,-1.387,
c     & 9.9,-1.038,-1.038,1.036,-1.034,-1.027,-1.009,-.964,-.821,
c     & 10.0,.472,-.472,.471,-.47,-.466,-.456,-.428,-.333,
c     & 10.1,.009,.009,.01,.011,.014,.022,.042,.111,
c     & 10.2,.452,.452,.452,.453,.455,.46,.473,.523,
c     & 10.3,.85,.85,.851,.851,.853,.856,.866,.906,
c     & 10.4,1.218,1.218,1.218,1.219,1.22,1.223,1.231,1.267,
c     & 10.5,1.574,1.574,1.574,1.575,1.576,1.578,1.585,1.619,
c     & 11.0,3.182,3.182,3.182,3.182,3.182,3.183,3.185,3.199,
c     24Mg --> 24Na: gamma ray heating rates
c     & 9.,-49.567,-33.465,-23.045,-16.198,-11.615,-8.453,-6.049,-4.032,
c     & 9.1,-36.614,-25.368,-18.05,-13.186,-9.784,-7.28,-5.266,-3.516,
c     & 9.2,-22.548,-16.493,-12.45,-9.676,-7.691,-6.072,-4.459,-2.97,  
c     & 9.3,-7.447,-6.977,-6.46,-5.91,-5.337,-4.668,-3.596,-2.394,
c     & 9.4,-3.731,-3.727,-3.716,-3.689,-3.617,-3.359,-2.682,-1.796,
c     & 9.5,-2.555,-2.545,-2.521,-2.467,-2.35,-2.13,-1.756,-1.193,
c     & 9.6,-1.171,-1.169,-1.165,-1.154,-1.128,-1.068,-.928,-6.16,
c     & 9.7,-.383,-.382,-.381,-.377,-.368,-.345,-.283,-.099,
c     & 9.8,.172,.173,.174,.175,.18,.192,.23,.357,
c     & 9.9,.63,.63,.631,.632,.636,.645,.672,.768,
c     & 10.0,1.045,1.045,1.046,1.047,1.049,1.055,1.074,1.149,
c     & 10.1,1.423,1.423,1.424,1.424,1.426,1.43,1.444,1.504,
c     & 10.2,1.77,1.77,1.77,1.771,1.772,1.775,1.786,1.836,
c     & 10.3,2.095,2.095,2.095,2.095,2.096,2.099,2.108,2.151,
c     & 10.4,2.404,2.405,2.405,2.405,2.406,2.407,2.415,2.452,
c     & 10.5,2.7,2.7,2.7,2.7,2.701,2.702,2.709,2.741, 
c     & 11.0,3.997,3.997,3.997,3.997,3.998,3.998,4.001,4.021/
  
      end module cap


      module rateselec
      use precision

      use cap

      implicit none
c LOCAL variables that are not in modules

      SAVE

c- dimensions of the Takahara table
      integer(kind=ik), parameter :: nroye=17, ntem=8

c- boundaries of the Takahara table
      real(kind=rk), parameter :: ltakroymax=11._rk,ltakroymin=9._rk,
     &     ltaktemax=9.6_rk,ltaktemin=8.2_rk

c- data of the Takahara table

      real(kind=rk) :: enune(nroye,ntem),enumg(nroye,ntem),
     &                 recne(nroye,ntem),recmg(nroye,ntem),
c    &                 gamne(nroye,ntem),gammg(nroye,ntem),
     &                 lroye(nroye), ltem(ntem)
      
      contains
      
      subroutine get_cap
c=======================================================================
c Autor           : Francisco Shu Kitaura
c Modul           : 
c Version         : 
c Date            : $Date: 2004/14/05 18:37:27 $
c
c purpose: electron capture rates
c=======================================================================
      use precision

      implicit none
c LOCAL variabrles that are not in modules

      integer(kind=ik) :: i,j

      do i = 2,18
         lroye(i-1) = pc_rates(i,1)
      enddo

      do i = 2,9
         ltem(i-1) = pc_rates(1,i)
      enddo

      do i = 2,18
         do j = 2,9
            recne(i-1,j-1) = pc_rates(i,j)
         enddo
      enddo
      do i = 19,35
         do j = 2,9
            recmg(i-18,j-1) = pc_rates(i,j)
         enddo
      enddo
      do i = 36,52
         do j = 2,9
            enune(i-35,j-1) = pc_rates(i,j)
         enddo
      enddo
      do i = 53,69
         do j = 2,9
            enumg(i-52,j-1) = pc_rates(i,j)
         enddo
      enddo


c      do i = 70,86
c         do j = 2,9
c            gamne(i-69,j-1) = pc_rates(i,j)
c         enddo
c      enddo
c      do i = 87,103
c         do j = 2,9
c            gammg(i-86,j-1) =  pc_rates(i,j)
c         enddo
c      enddo

c      open (10,file='rates.dat',status='unknown')
c      do i=1,nroye
c         write(10,100) i,lroye(i),recne(i,1:8),
c     &           recmg(i,1:8),enune(i,1:8),enumg(i,1:8)
c      enddo     
c 100  format(I4,33(2X,PE23.16))
c      close (10)

      end subroutine get_cap

      end module rateselec
